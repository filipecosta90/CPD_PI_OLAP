\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage{algorithm}
\usepackage{algorithmicx}
\usepackage{algpseudocode}
\usepackage{geometry}
 \geometry{
 a4paper,
 total={170mm,257mm},
 left=20mm,
 top=20mm,
 }


\begin{document}


\section{Hadamard}
\begin{algorithm}
\caption{CSR Hadamard Computation}\label{hada}
\begin{algorithmic}[1]

\Require A($m\times n$), B($m\times n$)
\Ensure C($m\times n$)
\Statex
\State $c\_pos \gets 0$
\For {$ row = 0$ \textbf{to} $m-1$}
    \State $C\_IA[row] \gets c\_pos$
    \State $col\_A\_pivot \gets A\_IA[row]$
    \State $col\_B\_pivot \gets B\_IA[row]$
    \State $col\_A\_limit \gets A\_IA[row+1]$
    \State $col\_B\_limit \gets B\_IA[row+1]$
    \State $A\_line\_size \gets col\_A\_limit - col\_A\_pivot$
    \State $B\_line\_size \gets col\_B\_limit - col\_B\_pivot$
    \Statex
    \If{$A\_line\_size > B\_line\_size$}
\For {$col\_A\_pivot$ \textbf{to} $col\_A\_limit-1 $}
\For {$col\_B\_pivot$ \textbf{to} $col\_B\_limit-1 ,$ \textbf{such that}  $(A\_JA[col\_A\_pivot] < B\_JA[col\_B\_pivot]) $}
    \State $++col\_B\_pivot$
    \EndFor
            \If{$A\_JA[col\_A\_pivot] == B\_JA[col\_B\_pivot]$}
               \State $C\_csr\_values[c\_pos] \gets A\_csr\_values[c\_pos] \times B\_csr\_values[c\_pos]$
               \State $C\_JA[c\_pos] \gets col\_A\_pivot$
               \State $++c\_pos$
            \EndIf
            \State $++col\_A\_pivot$
        \EndFor
    \Else
        \For {$col\_B\_pivot$ \textbf{to} $col\_B\_limit-1 $}
\For {$col\_A\_pivot$ \textbf{to} $col\_A\_limit-1 ,$ \textbf{such that}  $(A\_JA[col\_A\_pivot] < B\_JA[col\_B\_pivot]) $}
    \State $++col\_A\_pivot$
    \EndFor
            \If{$A\_JA[col\_A\_pivot] == B\_JA[col\_B\_pivot]$}
               \State $C\_csr\_values[c\_pos] \gets A\_csr\_values[c\_pos] \times B\_csr\_values[c\_pos]$
               \State $C\_JA[c\_pos] \gets col\_B\_pivot$
               \State $++c\_pos$
            \EndIf
            \State $++col\_B\_pivot$
        \EndFor
    \EndIf
\EndFor
    \Statex
\State $C\_IA[at\_row]=c\_pos$
\end{algorithmic}
\end{algorithm}

\newpage
\section{Kathri-Rao}
\begin{algorithm}
\caption{CSR Kathri-Rao Computation}\label{hada}
\begin{algorithmic}[1]

\Require A($m\times n$), B($o\times n$)
\Ensure C($(m\times o) \times n$)
\Statex
\State $A1 \gets A^{T}$
\State $B1 \gets B^{T}$
\Statex
\Require A1($n\times m$), B1($n\times o$)
\Statex

\State $c1\_pos \gets 0$
\For {$ at\_column = 0$ \textbf{to} $number\_columns-1$}
    \State $C\_IA1[at\_column] \gets c1\_pos$
    \State $line\_A\_pivot \gets IA[at\_column]$
    \State $line\_B\_pivot \gets B\_IA[at\_column]$
    \State $line\_A\_limit \gets IA[at\_column+1]$
    \State $line\_B\_limit = B\_IA[at\_column+1]$
    \Statex
	\For {$line\_A\_pivot=0$ \textbf{to} $line\_A\_limit-1 $}
		\State $line\_B\_pivot \gets B\_IA[at\_column]$
		\For {$ line\_B\_pivot = 0$ \textbf{to} $line\_B\_limit-1$}
			\State $C\_csc\_values[c1\_pos] =\gets A\_csc\_values[c1\_pos] \times B\_csc\_values[c1\_pos];$
			\State $C\_JA1[c1\_pos] \gets line\_A\_pivot \times line\_B\_pivot$
			\State $++c1\_pos$
		\EndFor
	\EndFor
\EndFor
\Statex
\State $C\_IA1[at\_column]=c1\_pos$
\end{algorithmic}
\end{algorithm}




\end{document}
